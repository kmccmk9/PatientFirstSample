//Import module definitions
var mongoose = require('mongoose');
var Schema = mongoose.Schema;

//region ENUMS
var eventTypeCode = 'rest 110100 110101 110102 110103 110104 110105 110106 110107 110108 110109 110110 110111 110112 110113 110114'.split(' ');
var eventTypeDisplay = "RESTful Operation,Application Activity,Audit Log Used,Begin Transferring DICOM Instances,DICOM Instances Accessed,DICOM Instances Transferred,DICOM Study Deleted,Export,Import,Network Entry,Order Record,Patient Record,Procedure Record,Query,Security Alert,User Authentication".split(',');
var eventSubTypeCode = '110120 110121 110122 110123 110124 110125 110126 110127 110128 110129 110130 110131 110132 110133 110134 110135 110136 110137 110138 110139 110140 110141 110142 read vread update delete history history-instance history-type history-system create search search-type search-system validate conformance transaction operation'.split(' ');
var eventSubTypeDisplay = "Application Start,Application Stop,Login,Logout,Attach,Detach,Node Authentication,Emergency Override Started,Network Configuration,Security Configuration,Hardware Configuration,Software Configuration,Use of Restricted Function,Audit Recording Stopped,Audit Recording Started,Object Security Attributes Changed,Security Roles Changed,User security Attributes Changed,Emergency Override Stopped,Remote Service Operation Started,Remote Service Operation Stopped,Local Service Operation Started,Local Service Operation Stopped,read,vread,update,delete,history,history-instance,history-type,history-system,create,search,search-type,search-system,validate,conformance,transaction,operation".split(',');
var eventAction = 'C R U D E'.split(' ');
var eventOutcome = '0 4 8 12'.split(' ');
var participantRoleCodingCode = '270002 375005 444000 609005 1354005 2272004 2316007 2368000 2481008 2959006 3425009 3851003 4577005 6676009 8458002 8674003 9306000 9947008 10896006 10960006 11286003 11393001 11434005 11773006 11993008 12241003 12629003 13038009 13157002 13443008 13646006 14469008 15130002 17219007 17925003 17945006 18205005 18906004 19343003 19686009 21093007 21464003 21506002 22387007 22573006 22609000 22963000 25211005 27508009 27733009 28010004 29539002 29644004 29787005 30578000 31656007 31831004 33969000 34581001 34871008 34972000 38048003 38248007 38265003 38312007 39062003 40683002 41057000 41795004 41953004 44181008 45929001 46363003 47801002 48385004 48673000 50058005 50261002 51616000 53201003 54056000 55538000 58293006 58626002 60614009 62090008 62296006 64988008 65412001 65616008 65656005 65853000 66089001 66839005 67005001 67147004 67822003 68021009 70578009 70862002 70924004 72012000 72705000 73678001 74128007 74489007 75226009 75615008 76022008 76087000 78194006 78272007 78652007 78872000 79508001 79756005 80386000 80587008 81173009 81276006 81467001 81706006 82101005 83408003 83420006 83559000 84390006 85058002 85411004 85683001 86372007 86764008 88510002 89681006 90921004 105428002 105429005 105431001 105436006 105437002 105438007 105449001 105450001 105451002 105452009 105453004 105454005 105455006 105456007 105457003 105458008 105459000 105460005 105461009 105462002 105463007 105464001 105465000 105466004 105467008 105468003 105469006 105470007 105471006 105472004 105473009 105474003 113157001 113158006 113159003 113160008 113161007 113163005 116153009 116154003 125677006 125678001 125679009 127848009 127849001 127850001 127851002 133931009 133932002 133933007 133936004 133937008 160234004 160498000 160505009 160506005 160540005 160542002 160543007 160544001 160545000 160549006 160557009 160558004 160560002 160562005 160563000 160566008 160567004 160772005 161158003 224080001 224526002 224527006 224528001 224619008 224627004 248544006 255409004 257497009 257498004 257499007 257500003 257501004 257502006 257503001 257504007 257505008 257506009 257508005 257509002 257510007 257511006 257512004 257513009 257514003 257516001 257517005 257518000 257519008 257521003 257522005 257523000 257524006 257525007 257526008 262043009 266943008 268557009 271448006 276035002 276036001 276037005 276119007 303069001 303071001 303072008 303073003 303118004 303119007 303120001 303121002 303122009 303977004 303980003 303981004 303983001 303984007 303985008 303986009 303987000 303988005 303989002 303990006 303991005 303992003 303993008 309456003 309687009 309884000 309885004 309886003 310543008 313415001 313416000 314712007 314767008 339947000 360852005 360863008 360984002 366740002 373864002 373929005 385435006 390790000 394566006 394567002 394568007 394571004 394619001 394738000 394854006 394855007 394856008 394857004 394858009 394859001 394860006 394861005 394862003 394863008 394921008 407542009 407543004 410597007 410598002 410599005 410600008 410601007 410602000 410603005 410604004 413327003 414043009 416034003 416035002 416625007 416800000 418119000 419358007 420058008 420158005 427568008 427729003 427754003 427755002 427874000 427950002 427963008 427981006 428024001 428315004 428347009 428373004 428376007 428378008 428407001 428408006 428410008 428496003 428503004 428504005 428506007 428620006 428666001 428792000 428801007 428815009 428816005 428820009 428821008 429158002 429171004 429379008 429509008 429511004 429527006 429533002 429534008 429539003 429543004 429544005 429545006 429547003 429577009 429644000 429708003 429732005 429787006 429790000 430098004 430101000 430792005 430882007 431549007 433152004 433475001 438347000 441463002 441465009 441468006 444018008 444052006 444053001 444054007 444055008 444145006 444146007 444147003 444148008 444168002 444169005 444191003 444192005 444193000 444194006 444199001 444210007 444211006 444212004 444213009 444241008 444242001 444243006 444244000 444278006 444279003 444280000 444292000 444293005 444294004 444295003 444301002 444302009 444303004 444304005 444464007 444870008 446654005 450768005 699110007 699111006 5161000124101 5171000124108 5181000124106 430971000124103 430981000124100 442031000124102 442041000124107 442051000124109 442061000124106 1421009 3430008 3842006 4162009 5275007 6816002 6868009 8724009 11661002 11911009 11935004 13580004 14698002 17561000 18803008 18850004 19244007 20145008 21365001 21450003 22515006 22731001 22983004 23278007 24430003 24590004 25961008 26042002 26369006 28229004 28411006 28544002 36682004 37154003 37504001 39677007 40127002 40204001 40570005 41672002 41904004 43702002 44652006 45419001 45440000 45544007 45956004 46255001 48740002 49203003 49993003 50149000 54503009 56397003 56466003 56542007 56545009 57654006 59058001 59169001 59944000 60008001 61207006 61246008 61345009 61894003 62247001 63098009 66476003 66862007 68867008 68950000 69280009 71838004 73265009 75271001 76166008 76231001 76899008 78703002 78729002 79898004 80409005 80546007 80584001 80933006 81464008 82296001 83189004 83273008 83685006 85733003 88189002 88475002 90201008 90655003 106289002 106291005 106292003 106293008 106294002 106296000 106330007 112247003 158965000 158966004 158967008 158968003 158969006 158970007 158971006 158972004 158973009 158974003 158975002 158977005 158978000 158979008 158980006 158983008 158984002 158985001 158986000 158987009 158988004 158989007 158990003 158992006 158993001 158994007 158995008 158996009 158997000 158998005 158999002 159000000 159001001 159002008 159003003 159004009 159005005 159006006 159007002 159010009 159011008 159012001 159013006 159014000 159016003 159017007 159018002 159019005 159021000 159022007 159025009 159026005 159027001 159028006 159033005 159034004 159035003 159036002 159037006 159038001 159039009 159040006 159041005 159141008 159972006 160008000 224529009 224530004 224531000 224532007 224533002 224534008 224535009 224536005 224537001 224538006 224540001 224541002 224542009 224543004 224544005 224545006 224546007 224547003 224548008 224549000 224550000 224551001 224552008 224553003 224554009 224555005 224556006 224557002 224558007 224559004 224560009 224561008 224562001 224563006 224564000 224565004 224566003 224567007 224569005 224570006 224571005 224572003 224573008 224574002 224575001 224576000 224577009 224578004 224579007 224580005 224581009 224583007 224584001 224585000 224586004 224587008 224588003 224589006 224590002 224591003 224592005 224593000 224594006 224595007 224596008 224597004 224598009 224599001 224600003 224601004 224602006 224603001 224604007 224605008 224606009 224607000 224608005 224609002 224610007 224614003 224615002 224620002 224621003 224622005 224623000 224624006 224625007 224626008 224936003 225726006 225727002 265937000 265938005 265939002 283875005 302211009 303124005 303129000 303133007 303134001 304291006 304292004 307988006 308002005 309294001 309295000 309296004 309322005 309323000 309324006 309326008 309327004 309328009 309329001 309330006 309331005 309332003 309333008 309334002 309335001 309336000 309337009 309338004 309339007 309340009 309341008 309342001 309343006 309345004 309346003 309347007 309348002 309349005 309350005 309351009 309352002 309353007 309354001 309355000 309356004 309357008 309358003 309359006 309360001 309361002 309362009 309363004 309364005 309365006 309366007 309367003 309368008 309369000 309371000 309372007 309373002 309374008 309375009 309376005 309377001 309378006 309379003 309380000 309381001 309382008 309383003 309384009 309385005 309386006 309388007 309389004 309390008 309391007 309392000 309393005 309394004 309395003 309396002 309397006 309398001 309399009 309400002 309401003 309402005 309403000 309404006 309409001 309410006 309411005 309412003 309413008 309414002 309415001 309416000 309417009 309418004 309419007 309420001 309421002 309422009 309423004 309427003 309428008 309429000 309434001 309435000 309436004 309437008 309439006 309440008 309441007 309442000 309443005 309444004 309445003 309446002 309450009 309452001 309453006 309454000 309455004 309459005 309460000 310170009 310171008 310172001 310173006 310174000 310175004 310176003 310177007 310178002 310179005 310180008 310181007 310182000 310183005 310184004 310185003 310186002 310187006 310188001 310189009 310190000 310191001 310192008 310193003 310194009 310512001 311441001 312485001 372102007 387619007 394572006 394618009 397824005 397897005 397903001 397908005 398130009 398238009 404940000 405277009 405278004 405279007 405623001 405684005 405685006 408798009 408799001 409974004 409975003 413854007 415075003 415506007 416160000 420409002 420678001 421841007 422140007 422234006 432100008 442867008 443090005 444912007 445313000 445451001 446050000 446701002 449161006 471302004 1271000175101 3981000175106 5191000124109 440051000124108 442251000124100 445521000124102 445531000124104 394745000 394746004 394747008 394748003 394749006 394751005 394757009 394758004 394760002 394762005 394763000 394764006 394765007 398154004 398255008'.split(' ');
var participantRoleCodingDisplay = "Female first cousin (person),Sibling (person),Legal sibling,Adoptive father (person),Orphan female (person),Half-sister (person),Adoptive son (person),Great great grandmother (person),Working mother (person),Female cousin (person),Oldest daughter (person),Surrogate daughter (person),First cousin (person),Youngest daughter (person),Foster father (person),Stepson (person),Legal parent (person),Natural father (person),Identical twin sibling,Working father (person),Twin sibling (person),Great great grandchild (person),Male second cousin (person),Legal brother (person),Male first cousin (person),Foster son (person),Single mother (person),Older brother (person),Older sibling (person),Second cousin (person),Natural parent (person),Legal child (person),Surrogate parent (person),Male fiance (person),Adoptive brother (person),Natural grandmother (person),Wesleyan Methodist, follower of religion (person),Foster sibling (person),Twin sister (person),Younger sister (person),Half-sibling (person),Adoptive mother (person),Female second cousin (person),Surrogate child (person),Stepdaughter (person),Adoptive grandparent (person),Legal sister (person),Aunt (person),Surrogate mother,Sister (person),Shiite muslim, follower of religion (person),Younger sibling (person),Fraternal twin sister (person),Foster brother (person),Stepfather (person),Adoptive grandmother (person),Foster daughter (person),Great grandparent (person),Niece (person),Grandfather (person),Only daughter (person),Uncle,Oldest son (person),Foster mother (person),Grandparent (person),Foster child (person),Parent (person),Surrogate son (person),Legal son (person),Adoptive parent (person),Granddaughter (person),Half-brother (person),Stepsister (person),Male cousin (person),Acquaintance (person),Adoptive child (person),Identical twin sister (person),Great grandfather (person),Sephardic Jew, follower of religion (person),Older sister (person),Trustee (person),Cousin (person),Foster sister (person),Legal guardian (person),Natural brother (person),Legal mother (person),Natural grandfather (person),Sunni muslim, follower of religion (person),Stepmother (person),Son (person),Natural mother (person),Student (occupation),Daughter (person),Father (person),Adoptive daughter (person),Legal father (person),Child (person),Great great grandparent (person),Grandson (person),Contact person (person),Brother (person),Great grandchild (person),Mother (person),Natural sister (person),Stepparent (person),Younger child (person),Natural child (person),Surrogate father (person),Adoptive sister (person),Stepbrother (person),Identical twin brother (person),Natural grandparent (person),Great grandmother (person),Orphan male (person),Adoptive sibling (person),Boyfriend (person),Great great grandfather (person),Jehovah's Witness, follower of religion (person),Only son (person),Twin brother (person),Fraternal twin brother (person),Ashkenazi Jew, follower of religion (person),Natural sibling (person),Working parent (person),Natural daughter (person),Nephew (person),Girlfriend (person),Adoptive grandfather (person),Younger brother (person),Single father (person),Grandchild (person),Stepchild (person),Stepsibling (person),Youngest son (person),Foster parent (person),Homosexual parents (family) (person),Elderly parents (family) (person),Adopted person (person),Elderly person (person),Elderly man (person),Elderly woman (person),Sick relative (person),Alcoholic relative (person),Demented relative (person),Diabetic relative (person),Schizophrenic relative (person),Disabled relative (person),Donor for medical or surgical procedure (person),Live donor (person),Cadaver donor (person),Candidate donor (person),Accepted donor (person),Rejected donor (person),Organ donor (person),Donor of kidney for transplant (person),Donor for liver transplant (person),Eye donor for corneal transplant (person),Donor for heart transplant (person),Donor for lung transplant (person),Donor for heart-lung transplant (person),Tissue donor (person),Bone tissue donor (person),Blood donor (person),Bone marrow donor (person),Sperm donor for artificial insemination (person),Husband sperm donor for artificial insemination (person),Related sperm donor for artificial insemination (person),Grandmother (person),Fraternal twin sibling (person),Legal daughter (person),Natural son (person),Female fiance (person),Friend (person),Donor of control material (person),Patient (person),Relative (person),First degree blood relative (person),Blood relative (person),Spouse (person),Husband (person),Wife (person),Fiance (person),Infant (person),Caregiver (person),Newborn (person),Adult (person),Adolescent (person),Salvation Army member (person),School child (occupation),Common-law husband (person),Common-law wife (person),Roman Catholic,Atheist (person),Jewish, follower of religion (person),Christian Scientist, follower of religion (person),Hindu, follower of religion (person),Christian, follower of religion (person),Baptist, follower of religion (person),Methodist, follower of religion (person),Presbyterian, follower of religion (person),Pentecostalist, follower of religion (person),Evangelist, follower of religion (person),Christadelphian, follower of religion (person),Agnostic (person),Voluntary worker (person),Immigrant (person),Committed Christian, follower of religion (person),Woman (person),Person in the work environment (person),Employee (person),Migrant (person),General category of person (person),Rastafarian, follower of religion (person),Pregnant woman (person),Rider of animal (person),Rider of motorcycle (person),Rider of pedal cycle (person),Passenger (person),Occupant of motor vehicle (person),Occupant of tram (person),Pillion passenger (person),Person riding on outside of vehicle (person),Person travelling on outside of train (person),Front seat passenger (person),Back seat passenger (person),Occupant of animal-drawn vehicle (person),Passenger on commercial watercraft (person),Passenger on station (person),Passenger on train (person),Member of public (person),Member of public involved incidentally (person),Member of public on ground (person),Occupant of nonmotor vehicle (person),Pedestrian (person),Person trespassing on railway line (person),Railway employee on train (person),Recreational watercraft user (person),Swimmer (person),User of animal-drawn vehicle (person),Watercraft dweller (person),Waterskier (person),Partner in relationship (person),Single parent (person),Sportsman (person),Anglican, follower of religion (person),Voluntary helper (person),Voluntary visitor (person),Volunteer helper (person),Nonconformist (person),Person in the transport environment (person),Person in the family (person),Person in the home environment (person),Person in the religious environment (person),Person in the healthcare environment (person),Person in the community environment (person),Person in the recreational environment (person),Person in the educational environment (person),Crewmember (person),Occupant of railway vehicle (person),Driver of motor vehicle (person),Driver of animal-drawn vehicle (person),Passenger of animal-drawn vehicle (person),Passenger on pedal cycle (person),Occupant of watercraft (person),Occupant of aircraft (person),Horse rider (person),Passenger on aircraft (person),Crewmember on aircraft (person),Passenger of motor vehicle (person),Trespasser (person),Car passenger (person),Coach passenger (person),Clergy (person),Buddhist, follower of religion (person),Muslim, follower of religion (person),Protestant, follower of religion (person),Quaker, follower of religion (person),Graduate (person),Identical twin (person),Fraternal twin (person),Parachutist (person),Bird fancier (person),Man (person),Bum (person),Beggar (person),Hasidic Jew, follower of religion (person),Sikh, follower of religion (person),Outpatient (person),Orphan child (person),Individual (person),Asylum seeker (person),Great grandson (person),Great granddaughter (person),Extended family member (person),Employer (person),Guardian (person),Other related persons (person),Immediate family member (person),Non-immediate family member (person),Paternal grandfather (person),Maternal grandfather (person),Paternal grandmother (person),Maternal grandmother (person),Distant relative (person),Great uncle (person),Great aunt (person),Non-family member (person),Cohabitee (person),Informal carer (person),Primary carer (person),Person categorized by religious affiliation (person),Person categorized by age (person),Minor (person),Pre-teen (person),Childhood age person (person),Preschool child (person),Person in the legal environment (person),Subject of record (person),Student in full time education (occupation),Domestic partner (person),Primary screener (person),Secondary screener (person),Family reunion immigrant (person),Inpatient (person),Infant child (person),Subject of record or other provider of history (person),Provider of history other than subject (person),Performer of method (person),Neighbor (person),Elim Pentecostalist, follower of religion (person),Liberal Jew, follower of religion (person),Lutheran,Congregationalist, follower of religion (person),Haredi Jew, follower of religion (person),Advaitin Hindu, follower of religion (person),Zen Buddhist, follower of religion (person),Clinical trial participant (person),Anabaptist, follower of religion (person),Arya Samaj Hindu,Coptic Orthodox, follower of religion (person),Eastern Catholic, follower of religion (person),Ethiopian Orthodox Tewahedo, follower of religion (person),Theravada Buddhist, follower of religion (person),Wiccan, follower of religion (person),Shakti Hindu, follower of religion (person),Tibetan Buddhist, follower of religion (person),Orthodox Christian, follower of religion (person),Christian Spiritualist, follower of religion (person),Druid, follower of religion (person),Smarta Hindu, follower of religion (person),Nichiren Buddhist, follower of religion (person),Person exposed to disease (person),Ismaili Muslim,Ahmadi,Armenian Catholic, follower of religion,Pure Land Buddhist, follower of religion (person),Seventh Day Adventist, follower of religion (person),Greek Orthodox, follower of religion (person),Spiritualist, follower of religion (person),Shiva Hindu, follower of religion (person),Reform Jew, follower of religion (person),Vaishnava Hindu, follower of religion (person),New Kadampa Tradition Buddhist, follower of religion (person),Mahayana Buddhist, follower of religion (person),Masorti Jew, follower of religion (person),Calvinist, follower of religion (person),Taoist, follower of religion (person),Russian Orthodox, follower of religion (person),Sanatana Dharma, follower of religion (person),Shinto, follower of religion (person),Patient advocate (person),Orthodox Jew, follower of religion (person),Unitarian, follower of religion (person),Baha'i, follower of religion (person),Jain, follower of religion (person),Zoroastrian, follower of religion (person),Donor for intestine transplant (person),Whole blood donor (person),Stem cell donor (person),Human oocyte donor (person),Female child (person),Male child (person),Human oocyte donor, age 35 and older (person),Person categorized by affiliation with belief system (person),Sperm donor (person),Unknown sperm donor for artificial insemination (person),Unrelated known sperm donor for artificial insemination (person),Person with characteristic related to subject of record (person),Spouse of subject (person),Husband of subject (person),Wife of subject (person),Uncle of subject (person),Partner in relationship with subject (person),Boyfriend of subject (person),Girlfriend of subject (person),Person in family of subject (person),Homemaker (person),House husband (person),Aunt of subject (person),Child of subject (person),First degree blood relative of subject (person),Daughter of subject (person),Friend of subject (person),Cohabitee in relationship with subject (person),Common law husband of subject (person),Common law wife of subject,Domestic partner of subject (person),Son of subject (person),Grandparent of subject (person),Maternal grandfather of subject (person),Maternal grandmother of subject (person),FiancÃ© of subject (person),Female fiancÃ© of subject (person),Male fiancÃ© of subject (person),Paternal grandfather of subject (person),Paternal grandmother of subject (person),Parent of subject (person),Father of subject (person),Mother of subject (person),Sibling of subject (person),Brother of subject (person),Sister of subject (person),Recipient of biological material from subject (person),Apostolic Pentecostalist, follower of religion (person),Refugee (person),International student (occupation),Second degree blood relative (person),Second degree blood relative of subject (person),Parent in-law (person),Father in-law (person),Mother in-law (person),Living unrelated donor (person),Living related donor (person),Maternal uncle (person),Paternal uncle (person),Maternal aunt (person),Paternal aunt (person),Specialized surgeon (occupation),Radiation therapist (occupation),Chiropractor,Dental assistant (occupation),Auxiliary nurse (occupation),Specialized nurse (occupation),Hospital administrator (occupation),Plastic surgeon (occupation),Neuropathologist (occupation),Nephrologist (occupation),Obstetrician (occupation),School dental assistant (occupation),Medical microbiologist,Cardiologist (occupation),Dermatologist (occupation),Laboratory hematologist (occupation),Gerodontist (occupation),Removable prosthodontist (occupation),Specialized dentist (occupation),Neuropsychiatrist (occupation),Medical assistant (occupation),Orthopedic surgeon (occupation),Thoracic surgeon (occupation),Community health physician (occupation),Physical medicine specialist (occupation),Urologist (occupation),Electroencephalography specialist,Dental hygienist (occupation),Public health nurse (occupation),Optometrist (occupation),Neonatologist (occupation),Medical biochemist,Physiotherapist (occupation),Periodontist (occupation),Orthodontist (occupation),Internal medicine specialist (occupation),Dietitian (general) (occupation),Hematologist (occupation),Interpreter (occupation),Respiratory disease specialist (occupation),Medical X-ray technician (occupation),Occupational health nurse (occupation),Pharmaceutical assistant (occupation),Masseur (occupation),Rheumatologist (occupation),Neurosurgeon (occupation),Sanitarian (occupation),Pharmacist (occupation),Philologist (occupation),Dispensing optician (occupation),Oral surgeon (occupation),Endodontist (occupation),Faith healer (occupation),Neurologist (occupation),Public health physician (occupation),Medical record administrator (occupation),Cardiovascular surgeon (occupation),Fixed prosthodontist (occupation),General physician (occupation),Orthopedic technician (occupation),Psychologist (occupation),Public health nutritionist (occupation),Medical pathologist (occupation),Laboratory medicine specialist (occupation),Otorhinolaryngologist,Endocrinologist (occupation),Family medicine specialist (occupation),Allergist,Oral pathologist (occupation),Radiologist (occupation),Public health dentist (occupation),Prosthodontist (occupation),Specialized physician (occupation),Gastroenterologist (occupation),Nursing aid (occupation),Professional midwife (occupation),Practical aid (pharmacy) (occupation),Osteopath (occupation),Infectious diseases physician,General surgeon (occupation),Diagnostic radiologist (occupation),Auxiliary midwife (occupation),Translator (occupation),Occupational therapist (occupation),Psychiatrist (occupation),Nuclear medicine specialist (occupation),Clinical pathologist (occupation),Pediatrician (occupation),Other professional nurse (occupation),Anatomic pathologist (occupation),Gynecologist,General pathologist (occupation),Anesthesiologist (occupation),Other dietitian/public health nutritionist (occupation),Pedodontist (occupation),Geriatrics specialist (occupation),Dentist (occupation),Dietician/public health nutritionist (occupation),Professional nurse (occupation),Nursing personnel (occupation),Midwifery personnel (occupation),Physiotherapist/occupational therapist (occupation),Philologist, translator/interpreter (occupation),Medical doctor (occupation),Medical practitioner (occupation),Medical administrator - national (occupation),Consultant physician,Consultant surgeon (occupation),Consultant gynecology/obstetrics (occupation),Anesthetist (occupation),Hospital registrar (occupation),House officer (occupation),Occupational physician (occupation),Clinical medical officer (occupation),Medical practitioner - teaching (occupation),Dental administrator (occupation),Dental consultant (occupation),Dental general practitioner (occupation),Dental practitioner - teaching (occupation),Nurse administrator - national (occupation),Nursing officer - region (occupation),Nursing officer - district (occupation),Nursing administrator - professional body (occupation),Nursing officer - division (occupation),Nurse education director (occupation),Occupational health nursing officer (occupation),Nursing officer (occupation),Midwifery sister (occupation),Nursing sister (theater) (occupation),Staff nurse (occupation),Staff midwife (occupation),State enrolled nurse (occupation),District nurse (occupation),Private nurse (occupation),Community midwife (occupation),Health visitor (occupation),Clinic nurse (occupation),Practice nurse (occupation),School nurse (occupation),Nurse - teaching,Student nurse (occupation),Dental nurse (occupation),Community pediatric nurse (occupation),Hospital pharmacist (occupation),Retail pharmacist (occupation),Industrial pharmacist (occupation),Pharmaceutical officer H.A. (occupation),Trainee pharmacist (occupation),Medical radiographer (occupation),Diagnostic radiographer (occupation),Therapeutic radiographer (occupation),Trainee radiographer (occupation),Ophthalmic optician (occupation),Trainee optician (occupation),Remedial gymnast (occupation),Speech/language therapist (occupation),Orthoptist (occupation),Trainee remedial therapist (occupation),Dietitian (occupation),Podiatrist (occupation),Dental auxiliary (occupation),Electrocardiogram technician (occupation),Electroencephalogram technician (occupation),Artificial limb fitter (occupation),Audiology technician (occupation),Pharmacy technician (occupation),Trainee medical technician (occupation),Geneticist (occupation),Surgical corset fitter (occupation),Dental technician (occupation),Clinical assistant (occupation),Senior registrar (occupation),Registrar (occupation),Senior house officer (occupation),Medical officer (occupation),Health visitor, nurse/midwife (occupation),Registered nurse (occupation),Midwifery tutor (occupation),Accident and Emergency nurse (occupation),Triage nurse (occupation),Community nurse (occupation),Nursing continence advisor (occupation),Coronary care nurse (occupation),Diabetic nurse (occupation),Family planning nurse (occupation),Care of the elderly nurse (occupation),Infection control nurse (occupation),Intensive therapy nurse (occupation),Learning disabilities nurse (occupation),Neonatal nurse (occupation),Neurology nurse (occupation),Industrial nurse (occupation),Oncology nurse (occupation),Macmillan nurse (occupation),Marie Curie nurse (occupation),Pain control nurse (occupation),Palliative care nurse (occupation),Chemotherapy nurse (occupation),Radiotherapy nurse (occupation),Recovery nurse (occupation),Stoma care nurse (occupation),Theatre nurse (occupation),Pediatric nurse (occupation),Mental health nurse (occupation),Community mental health nurse (occupation),Renal nurse (occupation),Hemodialysis nurse (occupation),Tissue viability nurse (occupation),Nurse grade (occupation),Clinical nurse specialist (occupation),Nurse practitioner (occupation),Nursing sister (occupation),Charge nurse (occupation),Ward manager (occupation),Nursing team leader (occupation),Nursing assistant (occupation),Healthcare assistant (occupation),Nursery nurse (occupation),Healthcare service manager (occupation),Occupational health service manager (occupation),Community nurse manager (occupation),Behavior therapist (occupation),Behavior therapy assistant (occupation),Drama therapist (occupation),Domiciliary occupational therapist (occupation),Occupational therapy helper (occupation),Psychotherapist (occupation),Community-based physiotherapist (occupation),Play therapist (occupation),Play specialist (occupation),Play leader (occupation),Community-based speech/language therapist (occupation),Speech/language assistant (occupation),Professional counselor (occupation),Marriage guidance counselor (occupation),Trained nurse counselor (occupation),Trained social worker counselor (occupation),Trained personnel counselor (occupation),Psychoanalyst (occupation),Assistant psychologist (occupation),Community-based podiatrist (occupation),Foot care worker (occupation),Audiometrician (occupation),Audiometrist (occupation),Technical healthcare occupation (occupation),Occupational therapy technical instructor (occupation),Administrative healthcare staff (occupation),Complementary health worker (occupation),Supporting services personnel (occupation),Research associate (occupation),Research nurse (occupation),Human aid to communication (occupation),Palantypist (occupation),Note taker (occupation),Cuer (occupation),Lipspeaker (occupation),Interpreter for British sign language (occupation),Interpreter for Signs supporting English (occupation),General practitioner locum (occupation),Lactation consultant (occupation),Midwife counselor (occupation),Nursing occupation (occupation),Physio/occup/speech therapist (occupation),Medical/dental technicians (occupation),Parkinson's disease nurse (occupation),Specialist registrar (occupation),Member of mental health review tribunal (occupation),Hospital manager (occupation),Responsible medical officer (occupation),Independent doctor (occupation),Bereavement counselor (occupation),Surgeon (occupation),Medical technician (occupation),Remedial therapist (occupation),Accident and Emergency doctor (occupation),Clinical oncologist (occupation),Family planning doctor (occupation),Associate general practitioner (occupation),Partner of general practitioner (occupation),General practitioner assistant (occupation),Deputizing general practitioner (occupation),General practitioner registrar (occupation),Ambulatory pediatrician (occupation),Community pediatrician (occupation),Pediatric cardiologist (occupation),Pediatric endocrinologist (occupation),Pediatric gastroenterologist (occupation),Pediatric nephrologist (occupation),Pediatric neurologist (occupation),Pediatric rheumatologist (occupation),Pediatric oncologist (occupation),Pain management specialist (occupation),Intensive care specialist (occupation),Adult intensive care specialist (occupation),Pediatric intensive care specialist (occupation),Blood transfusion doctor (occupation),Histopathologist (occupation),Physician (occupation),Chest physician (occupation),Thoracic physician (occupation),Clinical hematologist (occupation),Clinical neurophysiologist (occupation),Clinical physiologist (occupation),Diabetologist (occupation),Andrologist (occupation),Neuroendocrinologist (occupation),Reproductive endocrinologist (occupation),Thyroidologist (occupation),Clinical geneticist (occupation),Clinical cytogeneticist (occupation),Clinical molecular geneticist (occupation),Genitourinary medicine physician (occupation),Palliative care physician (occupation),Rehabilitation physician (occupation),Child and adolescent psychiatrist (occupation),Forensic psychiatrist (occupation),Liaison psychiatrist (occupation),Psychogeriatrician (occupation),Psychiatrist for mental handicap (occupation),Rehabilitation psychiatrist (occupation),Obstetrician and gynecologist (occupation),Breast surgeon (occupation),Cardiothoracic surgeon (occupation),Cardiac surgeon (occupation),Ear, nose and throat surgeon (occupation),Endocrine surgeon (occupation),Thyroid surgeon (occupation),Pituitary surgeon (occupation),Gastrointestinal surgeon (occupation),General gastrointestinal surgeon (occupation),Upper gastrointestinal surgeon (occupation),Colorectal surgeon (occupation),Hand surgeon (occupation),Hepatobiliary surgeon (occupation),Ophthalmic surgeon (occupation),Pediatric surgeon (occupation),Pancreatic surgeon (occupation),Transplant surgeon (occupation),Trauma surgeon (occupation),Vascular surgeon (occupation),Medical practitioner grade (occupation),Hospital consultant (occupation),Visiting specialist registrar (occupation),Research registrar (occupation),General practitioner grade (occupation),General practitioner principal (occupation),Hospital specialist (occupation),Associate specialist (occupation),Research fellow (occupation),AHP - Allied Health Professional,Hospital-based dietitian (occupation),Domiciliary physiotherapist (occupation),General practitioner-based physiotherapist (occupation),Hospital-based physiotherapist (occupation),Private physiotherapist (occupation),Physiotherapy assistant,Hospital-based speech and language therapist (occupation),Arts therapist (occupation),Dance therapist (occupation),Music therapist (occupation),Renal dietitian (occupation),Liver dietitian (occupation),Oncology dietitian (occupation),Pediatric dietitian (occupation),Diabetes dietitian (occupation),Audiologist,Hearing therapist,Audiological scientist,Hearing aid dispenser,Community-based occupational therapist,Hospital-based occupational therapist (occupation),Social services occupational therapist (occupation),Orthotist (occupation),Surgical fitter (occupation),Hospital-based podiatrist (occupation),Podiatry assistant (occupation),Lymphedema nurse (occupation),Community learning disabilities nurse (occupation),Clinical nurse teacher (occupation),Community practice nurse teacher (occupation),Nurse tutor (occupation),Nurse teacher practitioner (occupation),Nurse lecturer practitioner (occupation),Outreach nurse (occupation),Anesthetic nurse (occupation),Nurse manager (occupation),Nurse administrator (occupation),Midwifery grade (occupation),Registered midwife (occupation),Student midwife (occupation),Parentcraft sister (occupation),Healthcare professional grade (occupation),Restorative dentist (occupation),Pediatric audiologist (occupation),Immunopathologist (occupation),Audiological physician (occupation),Clinical pharmacologist (occupation),Private doctor (occupation),Agency nurse (occupation),Behavioral therapist nurse (occupation),Cardiac rehabilitation nurse (occupation),Genitourinary nurse (occupation),Rheumatology nurse specialist (occupation),Continence nurse (occupation),Contact tracing nurse (occupation),General nurse (occupation),Nurse for the mentally handicapped (occupation),Liaison nurse (occupation),Diabetic liaison nurse (occupation),Nurse psychotherapist (occupation),Company nurse (occupation),Hospital midwife (occupation),Genetic counselor (occupation),Mental health counselor (occupation),Clinical psychologist (occupation),Educational psychologist (occupation),Coroner (occupation),Appliance officer (occupation),Medical oncologist (occupation),School medical officer (occupation),Integrated midwife (occupation),Registered nurse first assist (occupation),Optician (occupation),Medical secretary (occupation),Hospital nurse (occupation),Consultant anesthetist (occupation),Paramedic (occupation),Staff grade obstetrician (occupation),Staff grade practitioner (occupation),Medical student (occupation),Acting obstetric registrar (occupation),Physiotherapist technical instructor (occupation),Resident physician (occupation),Certified registered nurse anesthetist (occupation),Attending physician (occupation),Assigned practitioner (occupation),Professional initiating surgical case (occupation),Professional providing staff relief during surgical procedure (occupation),Consultant pediatrician (occupation),Consultant neonatologist (occupation),Health educator (occupation),Certified health education specialist (occupation),Circulating nurse (occupation),Perioperative nurse (occupation),Scrub nurse (occupation),Fellow of American Academy of Osteopathy (occupation),Oculoplastic surgeon (occupation),Retinal surgeon (occupation),Admitting physician (occupation),Medical ophthalmologist (occupation),Ophthalmologist (occupation),Health coach (occupation),Respiratory therapist (occupation),Podiatric surgeon (occupation),Hypnotherapist (occupation),Asthma nurse specialist (occupation),Nurse case manager (occupation),Primary care physician (occupation),Addiction medicine specialist (occupation),Physician assistant (occupation),Government midwife (occupation),Primary obstetrician (occupation),Nurse complex case manager (occupation),Private midwife (occupation),Medical Examiner (occupation),Licensed practical nurse (occupation),Advanced practice midwife (occupation),Lay midwife (occupation),General practice (organisation) (qualifier value),Regional office (qualifier value),Health Authority (qualifier value),Primary Care Group (qualifier value),Primary Care Trust (qualifier value),Special Health Authority (qualifier value),Hospice - independent (qualifier value),Independent provider (qualifier value),General practitioner practice (qualifier value),GDP practice (qualifier value),MoD practice (qualifier value),MoD hospital (qualifier value),Prison practice (qualifier value),Quality Improvement Template Task Force (qualifier value),Association of anesthesia clinical directors (qualifier value)".split(',');
var purposeOfUseCode = 'PurposeOfUse HMARKT HOPERAT DONAT FRAUD GOV HACCRED HCOMPL HDECD HDIRECT HLEGAL HOUTCOMS HPRGRP HQUALIMP HSYSADMIN MEMADMIN PATADMIN PATSFTY PERFMSR RECORDMGT TRAIN HPAYMT CLMATTCH COVAUTH COVERAGE ELIGDTRM ELIGVER ENROLLM REMITADV HRESCH CLINTRCH PATRQT FAMRQT PWATRNY SUPNWK PUBHLTH DISASTER THREAT TREAT CAREMGT CLINTRL ETREAT POPHLTH'.split(' ');
var purposeOfUseDisplay = "purpose of use,healthcare marketing,healthcare operations,donation,fraud,government,health accreditation,health compliance,decedent,directory,legal,health outcome measure,health program reporting,health quality improvement,health system administration,member administration,patient administration,patient safety,performance measure,records management,training,healthcare payment,claim attachment,coverage authorization,coverage under policy or program,eligibility determination,eligibility verification,enrollment,remittance advice,healthcare research,clinical trial research,patient requested,family requested,power of attorney,support network,public health,disaster,threat,treatment,Care Management,clinical trial,Emergency Treatment,population health".split(',');
var identifierUseCode = 'usual official temp secondary'.split(' ');
var identifierTypeCode = 'UDI SNO SB PLAC FILL DL PPN BRN MR MCN EN TAX NIIP PRN MD DR'.split(' ');
var identifierTypeDisplay = "Universal Device Identifier,Serial Number,Social Beneficiary Identifier,Placer Identifier,Filler Identifier,Driver's license number,Passport number, Breed Registry Number,Medical record number,Microchip Number,Employer number,Tax ID number,National Insurance Payor Identifier (Payor),Provider number,Medical License number,Donor Registration Number".split(',');
var networkType = '1 2 3 4 5'.split(' ');
var auditSourceTypeCode = '1 2 3 4 5 6 7 8 9'.split(' ');
var auditSourceTypeDisplay = "User Device,Data Interface,Web Server,Application Server,Database Server,Security Server,Network Device,Network Router,Other".split(',');
var objectTypeCode = '1 2 3 4'.split(' ');
var objectTypeDisplay = "Person,System Object,Organization,Other".split(',');
var objectRoleCode = '1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24'.split(' ');
var objectRoleDisplay = "Patient,Location,Report,Domain Resource,Master file,User,List,Doctor,Subscriber,Guarantor,Security User Entity,Security User Group,Security Resource,Security Granularity Definition,Practitioner,Data Destination,Data Repository,Schedule,Customer,Job,Job Stream,Table,Routing Criteria,Query".split(',');
var objectLifeCycleCode = '1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 17 18 19 20 21 22 23 24'.split(' ');
var objectLifeCycleDisplay = "Origination / Creation,Import / Copy from original,Amendment,Verification,Translation,Access / Use,De-identification,Aggregation, summarization, derivation,Report,Export / Copy to target,Disclosure,Receipt of disclosure,Archiving,Logical deletion,Permanent erasure / Physical destruction,Data Repository,Schedule,Customer,Job,Job Stream,Table,Routing Criteria,Query".split(',');
var securityLabelCode = '_Confidentiality L M N R U V ETH GDIS HIV PSY SCA SDV SEX STD TBOO DEMO DOB GENDER LIVARG MARST RACE REL B EMPL LOCIS SSP ADOL CEL DIA DRGIS EMP PDS PRS COMPT HRCOMPT RESCOMPT RMGTCOMPT ABSTRED AGGRED ANONYED MAPPED MASKED PSEUDED REDACTED SUBSETTED SYNTAC TRSLT VERSIONED CRYTOHASH DIGSIG HRELIABLE RELIABLE UNCERTREL UNRELIABLE CLINAST DEVAST HCPAST PACQAST PATAST PAYAST PROAST SDMAST CLINRPT DEVRPT HCPRPT PACQRPT PATRPT PAYRPT PRORPT SDMRPT SecurityPolicy ObligationPolicy ANONY AOD AUDIT AUDTR CPLYCC CPLYCD CPLYJPP CPLYOPP CPLYOSP CPLYPOL DEID DELAU ENCRYPT ENCRYPTR ENCRYPTT ENCRYPTU HUAPRV MASK MINEC PRIVMARK PSEUD REDACT RefrainPolicy NOAUTH NOCOLLECT NODSCLCD NODSCLCDS NOINTEGRATE NOLIST NOMOU NOORGPOL NOPAT NOPERSISTP NORDSCLCD NORDSCLCDS NORDSCLW NORELINK NOREUSE NOVIP ORCON PurposeOfUse HMARKT HOPERAT DONAT FRAUD GOV HACCRED HCOMPL HDECD HDIRECT HLEGAL HOUTCOMS HPRGRP HQUALIMP HSYSADMIN MEMADMIN PATADMIN PATSFTY PERFMSR RECORDMGT TRAIN HPAYMT CLMATTCH COVAUTH COVERAGE ELIGDTRM ELIGVER ENROLLM REMITADV HRESCH CLINTRCH PATRQT FAMRQT PWATRNY SUPNWK PUBHLTH DISASTER THREAT TREAT CAREMGT CLINTRL ETREAT POPHLTH _ActUSPrivacyLaw 42CFRPart2 CommonRule HIPAANOPP HIPAAPsyNotes HIPAASelfPay Title38Section7332'.split(' ');
var securityLabelDisplay = "Confidentiality,low,moderate,normal,restricted,unrestricted,very restricted,substance abuse information sensitivity,genetic disease information sensitivity,HIV/AIDS information sensitivity,psychiatry information sensitivity,sickle cell anemia,sexual assault, abuse, or domestic violence information sensitivity,sexuality and reproductive health information sensitivity,sexually transmitted disease information sensitivity,taboo,all demographic information sensitivity,date of birth information sensitivity,gender and sexual orientation information sensitivity,living arrangement information sensitivity,marital status information sensitivity,race information sensitivity,religion information sensitivity,business information sensitivity,employer information sensitivity,location information sensitivity,sensitive service provider information sensitivity,adolescent information sensitivity,celebrity information sensitivity,diagnosis information sensitivity,drug information sensitivity,employee information sensitivity,patient default sensitivity,patient requested sensitivity,compartment,human resource compartment,research project compartment,records management compartment,abstracted,aggregated,anonymized,mapped,masked,pseudonymized,redacted,subsetted,syntactic transform,translated,versioned,cryptographic hash function,digital signature,highly reliable,reliable,uncertain reliability,unreliable,clinician asserted,device asserted,healthcare professional asserted,patient acquaintance asserted,patient asserted,payer asserted,professional asserted,substitute decision maker asserted,clinician reported,device reported,healthcare professional reported,patient acquaintance reported,patient reported,payer reported,professional reported,substitute decision maker reported,security policy,obligation policy,anonymize,accounting of disclosure,audit,audit trail,comply with confidentiality code,comply with consent directive,comply with jurisdictional privacy policy,comply with organizational privacy policy,comply with organizational security policy,comply with policy,deidentify,delete after use,encrypt,encrypt at rest,encrypt in transit,encrypt in use,human approval,mask,minimum necessary,privacy mark,pseudonymize,redact,refrain policy,no disclosure without subject authorization,no collection,no disclosure without consent directive,no disclosure without information subject's consent directive,no integration,no unlisted entity disclosure,no disclosure without MOU,no disclosure without organizational authorization,no disclosure to patient, family or caregivers without attending provider's authorization,no collection beyond purpose of use,no redisclosure without consent directive,no redisclosure without information subject's consent directive,no disclosure without jurisdictional authorization,no relinking,no reuse beyond purpose of use,no unauthorized VIP disclosure,no disclosure without originator authorization,purpose of use,healthcare marketing,healthcare operations,donation,fraud,government,health accreditation,health compliance,decedent,directory,legal,health outcome measure,health program reporting,health quality improvement,health system administration,member administration,patient administration,patient safety,performance measure,records management,training,healthcare payment,claim attachment,coverage authorization,coverage under policy or program,eligibility determination,eligibility verification,enrollment,remittance advice,healthcare research,clinical trial research,patient requested,family requested,power of attorney,support network,public health,disaster,threat,treatment,Care Management,clinical trial,Emergency Treatment,population health,ActUSPrivacyLaw,42 CFR Part2,Common Rule,HIPAA notice of privacy practices,HIPAA psychotherapy notes,HIPAA self-pay,Title 38 Section 7332".split(',');
//endregion

//regex
var dateTimeMatch = [/-?[0-9]{4}(-(0[1-9]|1[0-2])(-(0[0-9]|[1-2][0-9]|3[0-1])))(T([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9](\.[0-9]+)?(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00)))/, 'Deceased DateTime must be in the format: 1992-12-31T23:59:59+14:00'];

module.exports = mongoose.model('AuditEvent', new Schema({
    id: mongoose.Schema.Types.ObjectId,
    resourceType: { type: String, required: true },
    affiliation: { type: String, select: false },
    event: {
        _id: false,
        type: {
            type: Schema.Types.Mixed,
            _id: false,
            system: { type: String, required: true },
            version: String,
            code: { type: String, enum: eventTypeCode, required: true },
            display: { type: String, enum: eventTypeDisplay },
            userSelected: Boolean
        },
        subtype: [{
            _id: false,
            system: { type: String, required: true },
            version: String,
            code: { type: String, enum: eventSubTypeCode, required: true },
            display: { type: String, enum: eventSubTypeDisplay },
            userSelected: Boolean
        }],
        action: { type: String, enum: eventAction, required: true },
        dateTime: { type: String, match: dateTimeMatch, required: true },
        outcome: { type: String, enum: eventOutcome, required: true },
        outcomeDesc: String,
        purposeOfEvent: [{
            _id: false,
            system: String,
            version: String,
            code: { type: String, enum: purposeOfUseCode },
            display: { type: String, enum: purposeOfUseDisplay },
            userSelected: Boolean
        }]
    },
    participant: [{
        _id: false,
        role: [{
            _id: false,
            coding: [{
                _id: false,
                system: String,
                version: String,
                code: { type: String, enum: participantRoleCodingCode },
                display: { type: String, enum: participantRoleCodingDisplay },
                userSelected: Boolean
            }],
            text: String
        }],
        reference: {
            _id: false,
            reference: { type: String, required: true },
            display: { type: String }
        },
        userId: {
            _id: false,
            use: { type: String, enum: identifierUseCode },
            type: {
                type: Schema.Types.Mixed,
                coding: [{
                    _id: false,
                    system: String,
                    version: String,
                    code: { type: String, enum: identifierTypeCode },
                    display: { type: String, enum: identifierTypeDisplay },
                    userSelected: Boolean
                }],
                text: String
            },
            system: String,
            value: String,
            period: {
                _id: false,
                start: { type: String, match: dateTimeMatch },
                end: { type: String, match: dateTimeMatch } //if not ongoing
            },
            assigner: {
                _id: false,
                reference: String,
                display: String
            }
        },
        altId: String,
        name: { type: String, required: true },
        requestor: { type: Boolean, required: true },
        location: {
            _id: false,
            reference: String,
            display: String
        },
        policy: [String],
        media: {
            _id: false,
            system: String,
            version: String,
            code: { type: String, enum: identifierTypeCode },
            display: { type: String, enum: identifierTypeDisplay },
            userSelected: Boolean
        },
        network: {
            _id: false,
            address: String,
            type: { type: Schema.Types.Mixed, enum: networkType }
        },
        purposeOfUse: [{
            _id: false,
            system: String,
            version: String,
            code: { type: String, enum: purposeOfUseCode },
            display: { type: String, enum: purposeOfUseDisplay },
            userSelected: Boolean
        }]
    }],
    source: {
        _id: false,
        site: String,
        identifier: {
            _id: false,
            use: { type: String, enum: identifierUseCode },
            type: {
                type: Schema.Types.Mixed,
                _id: false,
                coding: [{
                    _id: false,
                    system: String,
                    version: String,
                    code: { type: String, enum: identifierTypeCode },
                    display: { type: String, enum: identifierTypeDisplay },
                    userSelected: Boolean
                }],
                text: String
            },
            system: String,
            value: { type: String, required: true },
            period: {
                _id: false,
                start: { type: String, match: dateTimeMatch },
                end: { type: String, match: dateTimeMatch } //if not ongoing
            },
            assigner: {
                _id: false,
                reference: String,
                display: String
            }
        },
        type: {
            type: Schema.Types.Mixed,
            _id: false,
            system: String,
            version: String,
            code: { type: String, enum: auditSourceTypeCode },
            display: { type: String, enum: auditSourceTypeDisplay },
            userSelected: Boolean
        }
    },
    object: [{
        _id: false,
        identifier: {
            _id: false,
            use: { type: String, enum: identifierUseCode },
            type: {
                type: Schema.Types.Mixed,
                _id: false,
                coding: [{
                    _id: false,
                    system: String,
                    version: String,
                    code: { type: String, enum: identifierTypeCode },
                    display: { type: String, enum: identifierTypeDisplay },
                    userSelected: Boolean
                }],
                text: String
            },
            system: String,
            value: String,
            period: {
                _id: false,
                start: { type: String, match: dateTimeMatch },
                end: { type: String, match: dateTimeMatch } //if not ongoing
            },
            assigner: {
                _id: false,
                reference: String,
                display: String
            }
        },
        reference: {
            _id: false,
            reference: { type: String, required: true },
            display: String
        },
        type: {
            type: Schema.Types.Mixed,
            _id: false,
            system: { type: String, required: true },
            version: String,
            code: { type: String, enum: objectTypeCode, required: true },
            display: { type: String, enum: objectTypeDisplay },
            userSelected: Boolean
        },
        role: {
            _id: false,
            system: String,
            version: String,
            code: { type: String, enum: objectRoleCode },
            display: { type: String, enum: objectRoleDisplay },
            userSelected: Boolean
        },
        lifecycle: {
            _id: false,
            system: String,
            version: String,
            code: { type: String, enum: objectLifeCycleCode },
            display: { type: String, enum: objectLifeCycleDisplay },
            userSelected: Boolean
        },
        securityLabel: [{
            _id: false,
            system: String,
            version: String,
            code: { type: String, enum: securityLabelCode },
            display: { type: String, enum: securityLabelDisplay },
            userSelected: Boolean
        }],
        name: String,
        description: String,
        query: String,
        detail: [{
            _id: false,
            type: { type: Schema.Types.Mixed },
            value: String
        }]
    }]
}, { versionKey: false }));